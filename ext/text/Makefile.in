srcdir       = @srcdir@
top_builddir = @top_builddir@
top_srcdir   = @top_srcdir@

SCM_CATEGORY = text

include ../Makefile.ext

LIBFILES = text--gettext.$(SOEXT) text--tr.$(SOEXT) text--unicode.$(SOEXT)
SCMFILES = gettext.sci tr.sci unicode.sci

GENERATED = Makefile
XCLEANFILES = *.c $(SCMFILES)

text-gettext_OBJECTS = text--gettext.$(OBJEXT)
text-tr_OBJECTS = text--tr.$(OBJEXT)
text-unicode_OBJECTS = text--unicode.$(OBJEXT)
OBJECTS = $(text-gettext_OBJECTS) \
	  $(text-tr_OBJECTS) \
	  $(text-unicode_OBJECTS)

all : $(LIBFILES)
static : $(OBJECTS)

install : install-std

#
# text.gettext
#

text--gettext.$(SOEXT) : $(text-gettext_OBJECTS)
	$(MODLINK) text--gettext.$(SOEXT) $(text-gettext_OBJECTS) $(EXT_LIBGAUCHE) $(LIBS)

text--gettext.c gettext.sci : gettext.scm
	$(PRECOMP) -e -P -o text--gettext $(srcdir)/gettext.scm

#
# text.tr
#

text--tr.$(SOEXT) : $(text-tr_OBJECTS)
	$(MODLINK) text--tr.$(SOEXT) $(text-tr_OBJECTS) $(EXT_LIBGAUCHE) $(LIBS)

text--tr.c tr.sci : $(top_srcdir)/libsrc/text/tr.scm
	$(PRECOMP) -e -P -o text--tr $(top_srcdir)/libsrc/text/tr.scm

#
# text.unicode
#  NB: unicode_attr.c can be autogenerated by src/gen-unicode.scm.

text--unicode.$(SOEXT) : $(text-unicode_OBJECTS)
	$(MODLINK) text--unicode.$(SOEXT) $(text-unicode_OBJECTS) $(EXT_LIBGAUCHE) $(LIBS)

text--unicode.c unicode.sci : unicode.scm
	$(PRECOMP) -e -P -o text--unicode $(srcdir)/unicode.scm

text--unicode.$(OBJEXT) : text--unicode.c unicode_attr.h
